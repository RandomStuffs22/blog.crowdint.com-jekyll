<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <title>Crowd Interactive Tech Blog :: Blog</title>
  <link rel="stylesheet" href="/stylesheets/screen.css?853991" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="/stylesheets/print.css" type="text/css" media="print" />
  <link rel="stylesheet" href="/stylesheets/styles.css?853991" type="text/css" media="screen" />
  <link rel="stylesheet" href="/stylesheets/skribit.css" type="text/css" media="screen" />
  <link rel="stylesheet" href="/stylesheets/syntax.css" type="text/css" media="screen" />
  <link rel="alternate" type="application/rss+xml" title="RSS Feed for blog.crowdint.com" href="http://feeds.feedburner.com/CrowdInteractiveTechBlog" />
  <link href='http://fonts.googleapis.com/css?family=Arvo' rel='stylesheet' type='text/css'>
  <!--[if lt IE 8]><link rel="stylesheet" href="css/blueprint/ie.css" type="text/css" media="screen, projection"><![endif]-->
    <script type="text/javascript">
      var _gaq = _gaq || [];

      _gaq.push(['_setAccount', 'UA-17527068-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
</head>
<body>
  <div class="container">
    <div id="empty-header">
      <a href="/" id="home-link"><img src="/images/logo_03.png" id="logoHead" width="227" height="74" alt="LogoHead" onclick="_gaq.push(['_trackEvent', 'header', 'logo']);"/></a>
      <ul id="navMenu">
        <li><a href="http://www.crowdint.com/" onclick="_gaq.push(['_trackEvent', 'header', 'home']);"><span>HOME</span></a></li>
        <li><a href="http://www.crowdint.com/projects" onclick="_gaq.push(['_trackEvent', 'header', 'projects']);"><span>PROJECTS</span></a></li>
        <li><a href="http://www.crowdint.com/services" onclick="_gaq.push(['_trackEvent', 'header', 'services']);"><span>SERVICES</span></a></li>
        <li class="selected"><span>BLOG</span></li>
        <li><a href="http://www.crowdint.com/about_us" onclick="_gaq.push(['_trackEvent', 'header', 'about_us']);"><span>ABOUT</span></a></li>
        <li><a href="http://www.crowdint.com/" onclick="_gaq.push(['_trackEvent', 'header', 'contact']);"><span>CONTACT</span></a></li>
      </ul>
    </div>
    <div class="span-24 append-bottom testGlow">
      <div class="round-top span-24">
        &nbsp;
      </div>
      <div id="white-body" class="span-24">
        <div class="left-side span-17">
          
<div class="post prepend-1">
  <h1><a href="/2011/02/15/internationalizing-your-rails-app.html">Internationalizing your Rails application with i18n</a></h1>
  <p class="author">
    <span class="date"><b>Feb 15</b><br />2011</span>
  </p>
  <div class="body prepend-1 append-1">
    <div class="gravatar span-3"><img src="http://www.gravatar.com/avatar/2f2bc78de007915554f49c3ea0fef125" class="avatar" alt="Avatar" /></div>
    <div id='main'>
      <p>In this now-globalized world, we frequently want to reach audience that does not speak our language or does not speak as fluently as we wished or the other way around we do not speak their language, so the more IT’s continue expanding in our society the more we need to communicate our business,  projects or simply our ideas in other countries.</p>

<p>So let’s say you have your company’s web page in a Rails application, and you want it to be available in three different languages: English (default), Spanish and French.</p>

<p>Well, there's good news! Setting these options is piece of cake with Rails! Since it includes the i18n API, (a.k.a Rails internationalization).
With this API you only need to split your contents into .yml or .rb files, which we will be calling dictionaries, one for each language you want in your page, for example: en.yml, es.yml, fr.yml
You have to save them in the config/locales folder in your app.</p>

<p>The ‘tricky’ thing is that you must follow a order in your files, they must have the exact same structure for the labels, so you just need to add the translation, the examples of the dictionaries will be done in .yml:</p>

<div class="highlight"><pre><code class="ruby"><span class="n">en</span><span class="p">:</span>
  <span class="n">main_page</span><span class="p">:</span>
    <span class="n">hello</span><span class="p">:</span> <span class="err">“</span><span class="no">Hello</span><span class="err">”</span>
    <span class="n">welcome</span><span class="p">:</span> <span class="err">“</span><span class="no">Welcome</span> <span class="n">to</span>   <span class="no">My</span> <span class="no">Company</span><span class="err">”</span>
</code></pre>
</div>




<div class="highlight"><pre><code class="ruby"><span class="n">es</span><span class="p">:</span>
  <span class="n">main_page</span><span class="p">:</span>
    <span class="n">hello</span><span class="p">:</span> <span class="err">“</span><span class="no">Hola</span><span class="err">”</span>
    <span class="n">welcome</span><span class="p">:</span> <span class="err">“</span><span class="no">Bienvenido</span> <span class="n">a</span> <span class="no">Mi</span> <span class="no">Empresa</span><span class="err">”</span>
</code></pre>
</div>




<div class="highlight"><pre><code class="ruby"><span class="n">fr</span><span class="p">:</span>
  <span class="n">main_page</span><span class="p">:</span>
    <span class="n">hello</span><span class="p">:</span> <span class="err">“</span><span class="no">Salut</span><span class="err">”</span>
    <span class="n">welcome</span><span class="p">:</span> <span class="err">“</span><span class="no">Bienvenue</span> <span class="err">à</span> <span class="no">Mon</span> <span class="no">Entreprise</span><span class="err">”</span>
</code></pre>
</div>


<p>To set up the app you just need to add the following into your <em>Application Controller</em></p>

<div class="highlight"><pre><code class="ruby"><span class="n">before_filter</span> <span class="ss">:set_locale</span>

<span class="k">def</span> <span class="nf">set_locale</span>
 <span class="no">I18n</span><span class="o">.</span><span class="n">locale</span> <span class="o">=</span> <span class="n">extract_locale_from_tld</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">extract_locale_from_tld</span>
 <span class="n">parsed_locale</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">last</span>
 <span class="no">I18n</span><span class="o">.</span><span class="n">available_locales</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="n">parsed_locale</span><span class="o">.</span><span class="n">to_sym</span><span class="p">)</span> <span class="p">?</span> <span class="n">parsed_locale</span>  <span class="p">:</span> <span class="kp">nil</span>
<span class="k">end</span>
</code></pre>
</div>


<p>And you will need to create a scope in your routes files in order for your routes to work:</p>

<div class="highlight"><pre><code class="ruby"><span class="n">match</span> <span class="s1">&#39;/:locale&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;home#index&#39;</span>

<span class="n">scope</span> <span class="s2">&quot;(:locale)&quot;</span><span class="p">,</span> <span class="ss">:locale</span> <span class="o">=&gt;</span> <span class="sr">/en|es|fr/</span> <span class="k">do</span>
 <span class="n">resources</span> <span class="ss">:contact</span>
<span class="k">end</span>
</code></pre>
</div>


<p>With the <em>exctract_locale_from_tld</em> method in the ApplicationController the locale will be passed to the URL in the params, but you will get a not-so-nice url, like this: www.yourpage.com/contact?locale=en, so if you prefer to have more readable url, like for example www.yourpage.com/en/contact, you should use instead these methods:</p>

<div class="highlight"><pre><code class="ruby"> <span class="n">before_filter</span> <span class="ss">:set_locale</span>

 <span class="k">def</span> <span class="nf">set_locale</span>
   <span class="no">I18n</span><span class="o">.</span><span class="n">locale</span> <span class="o">=</span> <span class="n">params</span><span class="o">[</span><span class="ss">:locale</span><span class="o">]</span>
 <span class="k">end</span>

 <span class="k">def</span> <span class="nf">default_url_options</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">{})</span>
   <span class="p">{</span><span class="ss">:locale</span> <span class="o">=&gt;</span> <span class="no">I18n</span><span class="o">.</span><span class="n">locale</span><span class="p">}</span>
 <span class="k">end</span>
</code></pre>
</div>


<p>In order to switch language in your application you will probably need a menu with the supported languages, and your menu will need to pass the ##:locale of the selected language, to do it you can do something like this</p>

<div class="highlight"><pre><code class="ruby"><span class="o">.</span><span class="n">menu</span>
  <span class="o">=</span> <span class="n">link_to</span><span class="p">(</span><span class="s2">&quot;English&quot;</span><span class="p">,</span> <span class="ss">:locale</span> <span class="o">=&gt;</span> <span class="s2">&quot;en&quot;</span><span class="p">)</span>
  <span class="o">=</span> <span class="n">link_to</span><span class="p">(</span><span class="s2">&quot;Française&quot;</span><span class="p">,</span> <span class="ss">:locale</span> <span class="o">=&gt;</span> <span class="s2">&quot;fr&quot;</span><span class="p">)</span>
  <span class="o">=</span> <span class="n">link_to</span><span class="p">(</span><span class="s2">&quot;Español&quot;</span><span class="p">,</span> <span class="ss">:locale</span> <span class="o">=&gt;</span> <span class="s2">&quot;es&quot;</span><span class="p">)</span>
</code></pre>
</div>


<p>Now you need to tell rails where it is going to look for the dictionaries, and which language will be the default, usually (if you haven’t removed them) you will have this lines commented in the application.rb file.</p>

<div class="highlight"><pre><code class="ruby">  <span class="n">config</span><span class="o">.</span><span class="n">i18n</span><span class="o">.</span><span class="n">load_path</span> <span class="o">+=</span> <span class="no">Dir</span><span class="o">[</span><span class="no">Rails</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;my&#39;</span><span class="p">,</span> <span class="s1">&#39;locales&#39;</span><span class="p">,</span> <span class="s1">&#39;*.{rb,yml}&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_s</span><span class="o">]</span>
  <span class="n">config</span><span class="o">.</span><span class="n">i18n</span><span class="o">.</span><span class="n">default_locale</span> <span class="o">=</span> <span class="ss">:en</span>
</code></pre>
</div>


<p>If you have a lot of sections in your page, and you would like to have your dictionaries in separate folders depending on their section, you can save the folders in config/locales,  and have something like this, config/locales/views/home and save in there all the dictionaries for the home page.</p>

<div class="highlight"><pre><code class="ruby"><span class="n">en</span><span class="p">:</span>
 <span class="n">views</span><span class="p">:</span>
    <span class="n">home</span><span class="p">:</span>
      <span class="n">hello</span><span class="p">:</span> <span class="err">“</span><span class="no">Hello</span><span class="err">”</span>
      <span class="n">welcome</span><span class="p">:</span> <span class="err">“</span><span class="no">Welcome</span> <span class="n">to</span>   <span class="no">My</span> <span class="no">Company</span><span class="err">”</span>
</code></pre>
</div>




<div class="highlight"><pre><code class="ruby"><span class="n">es</span><span class="p">:</span>
 <span class="n">views</span><span class="p">:</span>
    <span class="n">home</span><span class="p">:</span>
      <span class="n">hello</span><span class="p">:</span> <span class="err">“</span><span class="no">Hola</span><span class="err">”</span>
      <span class="n">welcome</span><span class="p">:</span> <span class="err">“</span><span class="no">Bienvenido</span> <span class="n">a</span> <span class="no">Mi</span> <span class="no">Empresa</span><span class="err">”</span>
</code></pre>
</div>




<div class="highlight"><pre><code class="ruby"><span class="n">fr</span><span class="p">:</span>
 <span class="n">views</span><span class="p">:</span>
    <span class="n">home</span><span class="p">:</span>
      <span class="n">hello</span><span class="p">:</span> <span class="err">“</span><span class="no">Salut</span><span class="err">”</span>
      <span class="n">welcome</span><span class="p">:</span> <span class="err">“</span><span class="no">Bienvenue</span> <span class="err">à</span> <span class="no">Mon</span> <span class="no">Entreprise</span><span class="err">”</span>
</code></pre>
</div>


<p>And of course you will need to change the path you set in the application.rb file to something like this</p>

<div class="highlight"><pre><code class="ruby">  <span class="n">config</span><span class="o">.</span><span class="n">i18n</span><span class="o">.</span><span class="n">load_path</span> <span class="o">+=</span> <span class="no">Dir</span><span class="o">[</span><span class="no">Rails</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;config&#39;</span><span class="p">,</span> <span class="s1">&#39;locales&#39;</span><span class="p">,</span> <span class="s1">&#39;**&#39;</span><span class="p">,</span> <span class="s1">&#39;*.{rb,yml}&#39;</span><span class="p">)</span><span class="o">]</span>
</code></pre>
</div>


<p>And finally, how do we get the text we want from our dictionaries files?
Well it’s easy, you just need to put the tags in the right order to obtain the text, for example, with:</p>

<div class="highlight"><pre><code class="ruby"><span class="o">.</span><span class="n">content</span>
  <span class="o">%</span><span class="n">h1</span>
    <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="s2">&quot;views.home.hello&quot;</span><span class="p">)</span>
  <span class="o">%</span><span class="nb">p</span>
    <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="s2">&quot;views.home.welcome&quot;</span><span class="p">)</span>
</code></pre>
</div>


<p>Something cool about this, is that in your dictionaries you can use HTML to give your text some style or format</p>

<div class="highlight"><pre><code class="ruby"><span class="n">en</span><span class="p">:</span>
<span class="n">views</span><span class="p">:</span>
  <span class="n">home</span><span class="p">:</span>
    <span class="n">hello</span><span class="p">:</span> <span class="err">“</span><span class="no">Hello</span><span class="err">”</span>
    <span class="n">welcome</span><span class="p">:</span> <span class="err">“</span><span class="no">Welcome</span> <span class="n">to</span> <span class="o">&lt;</span><span class="n">b</span><span class="o">&gt;</span><span class="no">Crowd</span> <span class="no">Interactive</span><span class="o">&lt;</span><span class="sr">/b&gt;”</span>
</code></pre>
</div>


<p>If you do this, you will need to use ‘raw’ to escape the HTML...</p>

<div class="highlight"><pre><code class="ruby"><span class="o">.</span><span class="n">content</span>
  <span class="o">%</span><span class="n">h1</span>
    <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="s2">&quot;views.home.hello&quot;</span><span class="p">)</span>
  <span class="o">%</span><span class="nb">p</span>
    <span class="o">=</span> <span class="n">raw</span> <span class="n">t</span><span class="p">(</span><span class="s2">&quot;views.home.welcome&quot;</span><span class="p">)</span>
</code></pre>
</div>


<p>Well, as you can see, it is pretty easy to set up i18n, and I hope this small guide help you through the internationalization process of your site!</p>

    </div>
    <div class="comments">
      <h2><a href="/2011/02/15/internationalizing-your-rails-app.html#disqus_thread">Click here for Comments</a></h2>
    </div>

    <p>
      <div class="tweet left">
        <a href="http://twitter.com/share"
          class="twitter-share-button"
          data-text="Internationalizing your Rails application with i18n"
          data-count="none"
          data-via="crowdint"
          data-related="Ana Rosas:with">Tweet</a>
        <script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
      </div>
    </p>
  </div>
      <div class="author_box">
      <p><b>Author:</b> Ana Rosas | ana.rosas@crowdint.com</p>
    </div>
</div>


<div class="post prepend-1">
  <h1><a href="/2011/02/05/auditrail-how-to-play-dirty-with-callbacks.html">Auditrail, how to play dirty with callbacks.</a></h1>
  <p class="author">
    <span class="date"><b>Feb 05</b><br />2011</span>
  </p>
  <div class="body prepend-1 append-1">
    <div class="gravatar span-3"><img src="http://www.gravatar.com/avatar/1e7f8fb8733b6193cf3bdbc85693f515" class="avatar" alt="Avatar" /></div>
    <div id='main'>
      <p>Recently, we've been working in a very interesting project here at Crowd Interactive. We needed to audit some of our models
in order to keep track of their changes, among other things. We searched for options (you know, plugins, gems, etc.)
to help us accomplish that task. We found a few ones, but eventually we came to a dead end when those tools
were not fitting our expectations, they were either too complicated or too rough for our needs. So, we decided to
create a new solution named <a href="http://github.com/crowdint/auditrail">auditrail</a>.</p>

<p>Auditrail is a gem that provides a highly configurable solution to audit your models. It provides two generators.
The first one creates the Audit model with a couple of methods that helps you use it, and the second creates the migration for its table.</p>

<h2>How is it used?</h2>

<p>Quite simple. You just need to install the <em>auditrail</em> gem, and then, run the generators provided
(<em>auditrail:migrations</em> and <em>auditrail:model</em>). Then you just need to call the method <em>auditable</em>
in the models you want to audit, and, that's it!</p>

<h2>How does it work?</h2>

<p>Auditrail was built to make it easily and readable. So, if you take a quick look at the source code
you can identify all the components.</p>

<ul>
<li><p>Auditrail keeps track of the changes in the audited models through the Audit model. Here, you can configure your own methods to manipulate those changes, or, you can place your filters or special actions.</p></li>
<li><p>Auditrail is a module that extends <em>ActiveRecord::Base</em>, so you can use it just by calling the <em>auditable</em>
method on the models you want to Audit. Simple, isn't it?</p></li>
<li><p>In order to manipulate the plugin requests auditrail uses a basic DSL to handle the method calls.
Those methods where built to specify a list of the attributes that you want to audit
and/or include the actor that is making the changes to the audited model.</p></li>
<li><p>It extends the ActiveSupport::Concern to facilitate the manipulation of the instance methods and the
class methods in the same module, dealing with the necessity to include an extend for the ActiveRecord::Base. Example:</p></li>
</ul>


<div class="highlight"><pre><code class="ruby"><span class="k">module</span> <span class="nn">Auditrail</span>
  <span class="kp">extend</span> <span class="no">ActiveSupport</span><span class="o">::</span><span class="no">Concern</span>

  <span class="k">module</span> <span class="nn">ClassMethods</span>

    <span class="k">def</span> <span class="nf">some_method</span>
      <span class="c1"># Include some code for your class method...</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="k">module</span> <span class="nn">InstanceMethods</span>

    <span class="k">def</span> <span class="nf">track_changes</span><span class="p">(</span><span class="o">*</span><span class="n">options</span><span class="p">)</span>
      <span class="c1"># Include some code for your instance method...</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="ss">:include</span><span class="p">,</span> <span class="no">Auditrail</span><span class="p">)</span>
</code></pre>
</div>


<ul>
<li><p>Auditrail uses ActiveRecord <em>callbacks</em> to trigger the methods that actually audit the models.</p></li>
<li><p>Once auditrail knows when an object is modified it will track the changes using <em>ActiveModel::Dirty</em>.</p></li>
<li><p>ActiveModel::Dirty returns a hash that we serialize in order to save them in our Audit model.</p></li>
<li><p>All these changes will be stored in the <em>dumped_changes</em> field on the audits table.</p></li>
</ul>


<p>*The dumped_changes fields is generated with type <strong>string</strong> by default, in case you're planing to track big models,
you should change its type to <strong>text</strong>.</p>

<p>Here you can find a list with the attributes on the Audit model:</p>

<div class="highlight"><pre><code class="ruby"><span class="o">==============</span>  <span class="o">====</span>      <span class="o">===========================================================================</span>
<span class="no">Attribute</span>         <span class="no">Type</span>      <span class="no">Usage</span>
<span class="o">--------------</span>  <span class="o">----</span>      <span class="o">---------------------------------------------------------------------------</span>
<span class="ss">:dumped_changes</span>    <span class="n">text</span>      <span class="no">Keep</span> <span class="n">the</span> <span class="n">changes</span> <span class="n">of</span> <span class="n">the</span> <span class="n">model</span> <span class="n">serialized</span><span class="o">.</span>
<span class="ss">:action</span>            <span class="n">string</span>    <span class="no">Indicates</span> <span class="n">whether</span> <span class="n">was</span> <span class="n">creation</span> <span class="p">(</span><span class="s2">&quot;creating&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">an</span> <span class="n">update</span> <span class="p">(</span><span class="s2">&quot;updating&quot;</span><span class="p">)</span><span class="o">.</span>
<span class="ss">:model_changed</span>     <span class="n">string</span>    <span class="no">Indicates</span> <span class="n">the</span> <span class="n">model</span> <span class="n">that</span> <span class="n">changed</span><span class="o">.</span>
<span class="ss">:element_id</span>        <span class="n">integer</span>   <span class="no">Indicates</span> <span class="n">the</span> <span class="n">element</span> <span class="n">from</span> <span class="n">the</span> <span class="n">audited</span> <span class="n">model</span> <span class="n">that</span> <span class="n">has</span> <span class="n">changed</span><span class="o">.</span>
<span class="ss">:invoker</span>           <span class="n">string</span>    <span class="no">Optional</span><span class="p">,</span> <span class="n">you</span> <span class="n">can</span> <span class="n">chose</span> <span class="k">if</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">store</span> <span class="n">the</span> <span class="n">action</span> <span class="n">invoker</span> <span class="p">(</span><span class="n">user</span><span class="p">)</span><span class="o">.</span>
<span class="ss">:timestamps</span>                  <span class="no">You</span> <span class="n">can</span> <span class="n">use</span> <span class="n">the</span> <span class="n">timestamps</span> <span class="n">to</span> <span class="n">determine</span> <span class="k">when</span> <span class="n">the</span> <span class="n">audited</span> <span class="n">model</span> <span class="n">has</span> <span class="n">changed</span><span class="o">.</span>
<span class="o">==============</span>  <span class="o">=======</span>   <span class="o">===========================================================================</span>
</code></pre>
</div>


<p>As with all open source projects, feel free to collaborate with this
gem by forking it on github.</p>

    </div>
    <div class="comments">
      <h2><a href="/2011/02/05/auditrail-how-to-play-dirty-with-callbacks.html#disqus_thread">Click here for Comments</a></h2>
    </div>

    <p>
      <div class="tweet left">
        <a href="http://twitter.com/share"
          class="twitter-share-button"
          data-text="Auditrail, how to play dirty with callbacks."
          data-count="none"
          data-via="crowdint"
          data-related="Luis Galaviz:with">Tweet</a>
        <script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
      </div>
    </p>
  </div>
      <div class="author_box">
      <p><b>Author:</b> Luis Galaviz | luis.galaviz@crowdint.com</p>
    </div>
</div>


<div class="post prepend-1">
  <h1><a href="/2011/01/31/attack-of-the-backticks.html">Attack of the backtick</a></h1>
  <p class="author">
    <span class="date"><b>Jan 31</b><br />2011</span>
  </p>
  <div class="body prepend-1 append-1">
    <div class="gravatar span-3"><img src="http://www.gravatar.com/avatar/d32b52ec6403614b1adf3e648cbbe584" class="avatar" alt="Avatar" /></div>
    <div id='main'>
      <p>It all started because I was getting some weird warning while running
the specs on one of my apps.</p>

<p>I know that, as a developer, I am suppposed to ignore all warnings, but,
this one felt ackward, so I had to track it down.</p>

<div class="highlight"><pre><code class="bash">/Users/dab/.rvm/gems/ree-1.8.7-2010.02@project/gems/activerecord-3.0.3/lib/active_record/base.rb:1838: <span class="nb">command </span>not found:
</code></pre>
</div>


<p>What? Why is activerecord trying to run some command? what command? and
why it isn't finding that command?</p>

<p>Let's figure it out. So, I opened base.rb an went to line 1838 and all I saw was
something like this:</p>

<div class="highlight"><pre><code class="ruby"><span class="k">def</span> <span class="nf">convert_number_column_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="kp">false</span>
    <span class="mi">0</span>
  <span class="k">elsif</span> <span class="n">value</span> <span class="o">==</span> <span class="kp">true</span>
    <span class="mi">1</span>
  <span class="k">elsif</span> <span class="n">value</span><span class="o">.</span><span class="n">is_a?</span><span class="p">(</span><span class="nb">String</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">value</span><span class="o">.</span><span class="n">blank?</span>
    <span class="kp">nil</span>
  <span class="k">else</span>
    <span class="n">value</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>


<p>Nothing useful there, line 1838 was just doing some if thing. So, what's
going on?</p>

<p>I went through lots of source files, trying to narrow down the
posibilites. But I just couldn't find anything unusual. If there was a
syntax error, why is the code not breaking completely, it's just a
warning on STDOUT.</p>

<p>I ended up doing the worst thing ever (for me, anyway) to figure out this
one, run the code with <em>ruby-debug</em>, put a couple of breakpoints. I feel
dirty just by admiting that.</p>

<p>Anyway, the problem was caused by some unintentional mistake:</p>

<div class="highlight"><pre><code class="ruby"><span class="n">items_returned</span> <span class="o">&lt;&lt;</span> <span class="n">item</span> <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">cancelled?</span><span class="sb">``</span>
</code></pre>
</div>


<p>How could I have missed that? the <em>backticks</em> at the end of the line, of
course.</p>

<p>In ruby, the backtick method returns the standard output of running the string encompassed
by the backticks in a subshell.</p>

<p>Yes, it is a method, like almost every operator in Ruby.</p>

<p>A few examples:</p>

<div class="highlight"><pre><code class="ruby"><span class="n">hey</span> <span class="o">=</span> <span class="sb">`echo hey`</span> <span class="c1"># =&gt; &quot;hey\n&quot;</span>
<span class="n">list_of_files</span> <span class="o">=</span> <span class="sb">`ls`</span> <span class="c1"># =&gt; &quot;file1\nfile2\nfile3\n&quot;</span>
</code></pre>
</div>


<p>It also sets a special variable $? with a Process::Status object with
the PID of that subshell.</p>

<div class="highlight"><pre><code class="ruby"><span class="sb">`exit 99`</span>
<span class="vg">$?</span>           <span class="c1">#  =&gt; # &lt;Process::Status: pid 7781 exit 99&gt;</span>
<span class="vg">$.</span><span class="n">exitstatus</span> <span class="c1">#  =&gt; 99</span>
</code></pre>
</div>


<p>So, I guess what was happening is that, the <em>cancelled?</em> method was
taking the result of `` as a parameter, in this case, a string, printing the result of that to
STDOUT and just ignoring the value of the parameter.</p>

<p>In other words, I was calling <em>cancelled?</em> like this:</p>

<div class="highlight"><pre><code class="ruby"><span class="n">cancelled?</span><span class="p">(</span><span class="sb">``</span><span class="p">)</span>
</code></pre>
</div>


<p>But, since cancelled wasn't expecting a parameter at all, it just
ignored the input. That's why I wasn't getting a syntax error or a
runtime error.</p>

<p>Probably nothing useful on my experience, since this is such a weird
problem to have, yet I just felt like explaining the power of the backticks.</p>

<p>Cheers</p>

    </div>
    <div class="comments">
      <h2><a href="/2011/01/31/attack-of-the-backticks.html#disqus_thread">Click here for Comments</a></h2>
    </div>

    <p>
      <div class="tweet left">
        <a href="http://twitter.com/share"
          class="twitter-share-button"
          data-text="Attack of the backtick"
          data-count="none"
          data-via="crowdint"
          data-related="David Padilla:with">Tweet</a>
        <script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
      </div>
    </p>
  </div>
      <div class="author_box">
      <p><b>Author:</b> David Padilla | david@crowdint.com</p>
    </div>
</div>


<div class="pagination prepend-1">
  
    
      <a href="/page9" class="previous">Previous</a>
    
  
  <span class="page_number ">Page: 10 of 21</span>
  
    <a href="/page11" class="next ">Next</a>
  
</div>

<div class="post prepend-1">
  <h1>Recent Posts</h1>
  <ul class="archives">

  <li><span><b>03 Feb 2012</b></span> &raquo; <a href="/2012/02/03/bootstrap-in-the-asset-pipeline.html">Twitter's Bootstrap in the Asset Pipeline</a></li>

  <li><span><b>07 Dec 2011</b></span> &raquo; <a href="/2011/12/07/serving-remote-content-with-dragonfly.html">Serving Remote Content with Dragonfly</a></li>

  <li><span><b>30 Nov 2011</b></span> &raquo; <a href="/2011/11/30/concerning-rails-3-internals.html">Concerning Rails 3 Internals</a></li>

  <li><span><b>15 Nov 2011</b></span> &raquo; <a href="/2011/11/15/making-gems-with-jeweler.html">Making gems with jeweler</a></li>

  <li><span><b>24 Oct 2011</b></span> &raquo; <a href="/2011/10/24/cucumber-steak.html">Has Cucumber become more ... "Steak"?</a></li>

  <li><span><b>05 Oct 2011</b></span> &raquo; <a href="/2011/10/05/using-rbenv-for-managing-your-rubies.html">Using rbenv to manage your rubies</a></li>

  <li><span><b>27 Sep 2011</b></span> &raquo; <a href="/2011/09/27/better-seo-with-rich-snippets-for-e-commerce.html">Better SEO with Rich Snippets for eCommerce</a></li>

  <li><span><b>05 Sep 2011</b></span> &raquo; <a href="/2011/09/05/ruby-benchmarks.html">Ruby benchmarks</a></li>

  <li><span><b>22 Aug 2011</b></span> &raquo; <a href="/2011/08/22/auto-retry-failed-cucumber-tests.html">Auto Retry Failed Cucumber Tests</a></li>

  <li><span><b>11 Aug 2011</b></span> &raquo; <a href="/2011/08/11/postgresql-in-vagrant.html">How to install Postgresql 8.4 in a Vagrant box</a></li>

  <li><span><b>06 Jul 2011</b></span> &raquo; <a href="/2011/07/06/acceptance-testing-with-steak.html">Acceptance testing with Steak</a></li>

  <li><span><b>27 Jun 2011</b></span> &raquo; <a href="/2011/06/27/rails-3-1-compass-and-blueprint.html">Rails 3.1, Compass and Blueprint (Updated)</a></li>

  <li><span><b>21 Jun 2011</b></span> &raquo; <a href="/2011/06/21/vagrant.html">Vagrant to manage multiple dev environments</a></li>

  <li><span><b>13 Jun 2011</b></span> &raquo; <a href="/2011/06/13/add-validations-to-your-ruby-classes.html">Add Validations to your Ruby classes</a></li>

  <li><span><b>24 May 2011</b></span> &raquo; <a href="/2011/05/24/railsconf-2011.html">Railsconf 2011</a></li>

  <li><span><b>02 May 2011</b></span> &raquo; <a href="/2011/05/02/How-to-override-destroy-with-callbacks.html">How to override destroy method keeping the callbacks</a></li>

  <li><span><b>25 Apr 2011</b></span> &raquo; <a href="/2011/04/25/one-file-web-page-with-rack.html">One File Web Page with Rack</a></li>

  <li><span><b>13 Apr 2011</b></span> &raquo; <a href="/2011/04/13/turn-jquery-effects-off-for-testing.html">Turn jQuery effects off for testing</a></li>

  <li><span><b>06 Apr 2011</b></span> &raquo; <a href="/2011/04/06/sinatra-haml-compass-blueprint.html">How to Sinatra + Haml + Compass(SCSS) + Blueprint</a></li>

  <li><span><b>31 Mar 2011</b></span> &raquo; <a href="/2011/03/31/make-your-sinatra-more-restful.html">Trying to make your Sinatra more RESTful?</a></li>

  </ul>
</div>

<div class="post prepend-1">
  <div class="left">
    <!-- http://www.facebook.com/pages/Crowd-Interactive/63293958828  -->
    <iframe src="http://www.facebook.com/plugins/like.php?href=http%3A%2F%2Fwww.facebook.com%2Fpages%2FCrowd-Interactive%2F63293958828" scrolling="no" frameborder="0" style="height: 62px; width: 100%" allowTransparency="true"></iframe>
  </div>
</div>

        </div>
        <div class="right-side span-5 last prepend-1">
          <h1><a href="/">Blog Home</a></h1>
<h1>About Crowd Interactive</h1>
<p class="append-1 about">Crowd Interactive is a Ruby on Rails
consultancy firm powered by a team of enthusiast engineers that love
programming.We turn your ideas into web applications...<br/><a href="/about.html">Read More...</a></p>
<h1>Our Favorite Sites</h1>
<ul>
  <li><a href="http://www.crowdint.com">Crowd Interactive</a></li>
  <li><a href="http://www.magmarails.com">MagmaRails</a></li>
  <li><a href="http://rubyonrails.org">Ruby on Rails</a></li>
  <li><a href="http://ruby-lang.org">Ruby-Lang</a></li>
  <li><a href="http://github.com/crowdint">Github</a></li>
</ul>
<h1>Stuff we've built</h1>
<ul>
  <li><a href="http://www.modcloth.com">ModCloth</a></li>
  <li><a href="http://www.creativeallies.com">Creative Allies</a></li>
  <li><a href="http://www.nameframe.com">Nameframe</a></li>
  <li><a href="http://github.com/crowdint/rails3-jquery-autocomplete">Rails3-jQuery-Autocomplete</a></li>
  <li><a href="http://github.com/crowdint/rankstar">rankstar</a></li>
  <li><a href="http://github.com/crowdint/blog.crowdint.com">This site's source code</a></li>
</ul>
<h1>Older Posts</h1>
<ul>
  <li><a href="/archive.html">Archive</a></li>
</ul>
	  <iframe src="http://www.facebook.com/plugins/likebox.php?href=http%3A%2F%2Fwww.facebook.com%2Fpages%2FCrowd-Interactive%2F63293958828&amp;width=190&amp;colorscheme=light&amp;show_faces=true&amp;border_color&amp;stream=false&amp;header=false&amp;height=380px" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:190px; height:380px;" allowTransparency="true"></iframe>
Site Powered by <a href="http://github.com/mojombo/jekyll">Jekyll</a>

        </div>
      </div>
      <div class="round-bottom span-24">
        &nbsp;
      </div>
    </div>

  </div>
  <div id="footer">
    <div class="copyContent" >
      <p class="copy">Copyright &copy; 2010, Crowd Interactive. All rights reserved.</p>
    </div>
  </div>
  <script type="text/javascript">
  var disqus_shortname = 'crowdinttech';
  (function () {
    var s = document.createElement('script'); s.async = true;
    s.src = 'http://disqus.com/forums/crowdinttech/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  }());
  </script>
</body>
</html>
